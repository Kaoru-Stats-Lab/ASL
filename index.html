<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adult Stats Lab</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #0f172a; color: #f1f5f9; }
        .bar-gradient { background: linear-gradient(90deg, #ff6b95 0%, #ff3366 100%); }
        .sticky-btn { position: fixed; bottom: 1.5rem; left: 50%; transform: translateX(-50%); width: 90%; max-width: 400px; z-index: 50; }
    </style>
</head>
<body class="pb-28">
    <div id="content" class="max-w-md mx-auto p-4 space-y-6">
        <p class="text-center py-20 text-slate-500">解析データを読み込み中...</p>
    </div>

    <script>
        const API_URL = "https://script.google.com/macros/s/AKfycbyLLYLpgmY5gzFUlGQUohT6Zdw18CG71TgFgt_nPN0-_kTRRgD-6wZQzTDZE8QpZ4F26g/exec";

        async function fetchData() {
            try {
                const res = await fetch(API_URL);
                const data = await res.json();
                render(data);
            } catch (e) {
                document.getElementById('content').innerHTML = "データの取得に失敗しました。";
            }
        }

        function render(items) {
            const container = document.getElementById('content');
            container.innerHTML = items.map(item => `
                <div class="bg-slate-900 rounded-3xl p-6 shadow-2xl border border-slate-800 relative">
                    <div class="absolute top-4 right-4 bg-sky-600 text-[10px] font-bold px-2 py-1 rounded shadow">RANK ${item.TIER || 'A'}</div>
                    <h2 class="text-xl font-bold mb-4 pr-16 leading-tight">${item.TITLE}</h2>
                    
                    <div class="flex items-center gap-4 mb-6">
                        <div class="text-5xl font-black text-white">${item.T_SCORE}</div>
                        <div class="text-[10px] text-slate-500 leading-none">T-Score<br>Analyzed</div>
                    </div>

                    <div class="space-y-3 mb-6">
                        ${renderBar('VISUAL', item.VIS)}
                        ${renderBar('STYLE', item.STY)}
                        ${renderBar('TECH', item.TECH)}
                        ${renderBar('HEAT', item.HEA)}
                        ${renderBar('RARE', item.RAR)}
                        ${renderBar('VALUE', item.VAL)}
                    </div>

                    <div class="text-sm text-slate-400 leading-relaxed border-t border-slate-800 pt-4">
                        ${item.NARRATIVE_ALL || '解説データがありません。'}
                    </div>

                    <a href="https://www.dmm.co.jp/mono/dvd/-/detail/=/cid=${item.CID}/" 
                       class="mt-6 block bg-[#ff6b95] hover:bg-[#ff3366] text-white font-bold py-4 rounded-2xl text-center shadow-lg transition-transform active:scale-95">
                        GET FULL ANALYSIS DATA (FANZA)
                    </a>
                </div>
            `).join('');
        }

        function renderBar(label, val) {
            const percent = (parseFloat(val) / 5) * 100;
            return `
                <div class="flex items-center gap-3 text-[10px]">
                    <div class="w-12 font-bold text-slate-500">${label}</div>
                    <div class="flex-1 bg-slate-800 h-1.5 rounded-full overflow-hidden">
                        <div class="bar-gradient h-full" style="width: ${percent}%"></div>
                    </div>
                    <div class="w-6 text-right font-mono">${parseFloat(val).toFixed(1)}</div>
                </div>
            `;
        }

        fetchData();
    </script>
</body>
</html>
